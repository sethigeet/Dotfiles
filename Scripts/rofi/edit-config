#!/bin/bash

declare -A options
options[ alacritty]="$HOME/.config/alacritty/alacritty.yml"
options[ bash]="$HOME/.config/bash/init.bash"
options[ bashrc]="$HOME/.bashrc"
options[ bash_profile]="$HOME/.bash_profile"
options[ doom]="$HOME/.config/doom/config.el"
options[ fontconfig]="$HOME/.config/fontconfig/fonts.conf"
options[ git]="$HOME/.config/git/config"
options[ i3]="$HOME/.config/i3/config"
options[ kitty]="$HOME/.config/kitty/kitty.conf"
options[ lynx]="$HOME/.config/lynx/lynx.cfg"
options[ mpv]="$HOME/.config/mpv/mpv.conf"
options[ neofetch]="$HOME/.config/neofetch/config.conf"
options[ nvim]="$HOME/.config/nvim/init.lua"
options[ pacwall]="$HOME/.config/pacwall/pacwall.conf"
options[ picom]="$HOME/.config/picom/picom.conf"
options[ polybar]="$HOME/.config/polybar/config.ini"
options[ qtile]="$HOME/.config/qtile/config.py"
options[ rofi]="$HOME/.config/rofi/config.rasi"
options[ shell]="$HOME/.config/shell/init.sh"
options[ sxhkd]="$HOME/.config/sxhkd/sxhkdrc"
options[節tmux]="$HOME/.config/tmux/tmux.conf"
options[ vifm]="$HOME/.config/vifm/vifmrc"
options[ vim]="$HOME/.config/vim/vimrc"
options[ vimiv]="$HOME/.config/vimiv/vimiv.conf"
options[ X11]="$HOME/.config/X11/xprofile"
options[牢 zathura]="$HOME/.config/zathura/zathurarc"
options[ zsh]="$HOME/.config/zsh/init.zsh"

marked_up_config_names=""
for config in "${!options[@]}"; do
  config_name="$config"
  config_path=${options[$config]}

  marked_up_config_name="$config_name <span font_size='smaller' font_weight='light' style='italic'>(${config_path//\/home\/$USER/\~})</span>"

  if [[ -z "$marked_up_config_names" ]]; then
    marked_up_config_names="$marked_up_config_name"
  else
    marked_up_config_names="$marked_up_config_names
$marked_up_config_name"
  fi
done

selected_config_name=$(echo "$marked_up_config_names" | rofi -theme "$HOME/.config/rofi/themes/with-prompt.rasi" -markup-rows -dmenu -i -p "Edit config")
selected_config_name="${selected_config_name%% <span*}"

[[ -z "$selected_config_name" ]] && exit 0

# What to do when/if we choose a file to edit.
selected_config_path=$(printf '%s\n' "${options["$selected_config_name"]}")
selected_config_dir="${selected_config_path%/*}"

cd "$selected_config_dir" || exit 1

$TERMINAL -e nvim "$selected_config_path" &
